# Disables iptables, removes ufw and installs firewalld.
#
# Usage example
#
#   tasks:
#   - import_tasks: task_.yml
#     become: yes
#
---
- name: "Mask iptables and stop if in use"
  systemd:
    name: iptables
    masked: yes
    state: stopped

# Ensure ufw is not installed to avoid conflicts
- import_tasks: task_remove-pkgs.yml
  vars:
    remove_pkgs_list:
      - ufw

# Install firewalld from repository
- import_tasks: task_install-from-repo.yml
  vars:
    install_from_repo_packages:
      - firewalld

- name: "Enable firewalld"
  service:
    name: firewalld
    state: started
    enabled: yes
